{% extends "base.html" %}

{% block title %}Invoice Management{% endblock %}
{% block header_title %}Invoice Management{% endblock %}

{% block additional_css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/invoice_management.css') }}"/>
{% endblock %}

{% block content %}
<div class="invoice-management-content">
    <h2>Invoice Management</h2>

    <!-- Invoice Search Bar -->
    <div class="invoice-search">
        <span class="invoice-search-icon-left">
            <img src="{{ url_for('static', filename='images/search_icon.png') }}" alt="Search Icon">
        </span>
        <input type="text" placeholder="Search Invoices..." class="invoice-search-input">
        <span class="invoice-search-icon-right">
            <img src="{{ url_for('static', filename='images/updown_icon.png') }}" alt="Right Icon">
        </span>

        <!-- Dropdown Container -->
        <div class="invoice-dropdown" onclick="toggleDropdown()">
            <div class="invoice-dropdown-placeholder" id="invoice-dropdown-placeholder">
                <span>Filter by:</span> <!-- Placeholder text -->
                <span class="invoice-filter-icon">
                    <img src="{{ url_for('static', filename='images/filter_icon.png') }}" alt="Filter Icon">
                </span>
            </div>
            <div class="invoice-dropdown-content" onclick="preventDropdownClose(event)">
                <!-- Filter by title -->
                <div class="invoice-dropdown-title">Filter by:</div>
                
                <div class="invoice-left">
                    <!-- Content for the left column -->
                    <p class="invoice-item" onclick="showRightColumnContent('Approval Status')">Approval Status</p>
                    <p class="invoice-item" onclick="showRightColumnContent('Status')">Status</p>
                </div>
                <div class="invoice-right" id="invoice-right-content">
                    <!-- Content for the right column -->
                    <p>Select a filter</p>
                </div>
            </div>
        </div>
        <input type="hidden" id="status-filter" name="status_filter" value="">
        <input type="hidden" id="approval-status-filter" name="approval_status_filter" value="">
    </div>

    <!-- Invoice Management Table -->
<!-- Invoice Management Table -->
<table class="invoice-table">
    <thead>
        <tr>
            <th>Invoice ID</th>
            <th>Patient Name</th>
            <th>Date Issued</th>
            <th>Status</th>
            <th>Approval Status</th> 
            <th>Total Amount</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>INV12345</td>
            <td>Renz Paul Fababeir</td>
            <td>2024-09-01</td>
            <td>Open</td>
            <td>Pending Approval</td>
            <td class="tamount">₱11,500.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Open" data-approval="Pending Approval">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Open" data-approval="Pending Approval" onclick="toggleInsuranceBox('INV12345', event)">Apply Insurance</a>
                <div id="insurance-box-INV12345" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="#" class="insurance-option">Coverage</a>
                    <a href="#" class="insurance-option reimbursement-option">Reimbursement</a>
                </div>
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV12346</td>
            <td>Shane Steven Servas</td>
            <td>2024-09-01</td>
            <td>Fully Paid</td>
            <td>Approved</td>
            <td class="tamount">₱11,500.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Fully Paid" data-approval="Approved">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Partially Paid" data-approval="Approved" onclick="toggleInsuranceBox('INV12346', event)">Apply Insurance</a>
                <div id="insurance-box-INV12346" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="{{ url_for('invoice_coverage') }}" class="insurance-option">Coverage</a>
                    <a href="{{ url_for('invoice_reimbursement') }}" class="insurance-option reimbursement-option"">Reimbursement</a>
                </div>  
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV12347</td>
            <td>Kyle Mendoza</td>
            <td>2024-09-01</td>
            <td>Voided</td>
            <td>Rejected</td>
            <td class="tamount">₱11,500.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Voided" data-approval="Rejected">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Voided" data-approval="Rejected" onclick="toggleInsuranceBox('INV12347', event)">Apply Insurance</a>
                <div id="insurance-box-INV12347" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="#" class="insurance-option">Coverage</a>
                    <a href="#" class="insurance-option reimbursement-option">Reimbursement</a>
                </div>
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV12348</td>
            <td>Joshua Chua</td>
            <td>2024-09-01</td>
            <td>Open</td>
            <td>Approved</td>
            <td class="tamount">₱20,000.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Open" data-approval="Approved">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Partially Paid" data-approval="Approved" onclick="toggleInsuranceBox('INV12348', event)">Apply Insurance</a>
                <div id="insurance-box-INV12348" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="{{ url_for('invoice_coverage') }}" class="insurance-option">Coverage</a>
                    <a href="{{ url_for('invoice_reimbursement') }}" class="insurance-option reimbursement-option"">Reimbursement</a>
                </div>  
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV12349</td>
            <td>Julianne Dominique Torres</td>
            <td>2024-09-02</td>
            <td>Open</td>
            <td>Rejected</td>
            <td class="tamount">₱15,000.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="{{ url_for('invoice_edit') }}" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Open" data-approval="Rejected">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Open" data-approval="Rejected" onclick="toggleInsuranceBox('INV12349', event)">Apply Insurance</a>
                <div id="insurance-box-INV12349" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="{{ url_for('invoice_coverage') }}" class="insurance-option">Coverage</a>
                    <a href="{{ url_for('invoice_reimbursement') }}" class="insurance-option reimbursement-option">Reimbursement</a>
                </div>
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV12350</td>
            <td>Cherry Doromal</td>
            <td>2024-09-03</td>
            <td>Partially Paid</td>
            <td>Approved</td>
            <td class="tamount">₱8,000.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Partially Paid" data-approval="Approved">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Partially Paid" data-approval="Approved" onclick="toggleInsuranceBox('INV12350', event)">Apply Insurance</a>
                <div id="insurance-box-INV12350" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="{{ url_for('invoice_coverage') }}" class="insurance-option">Coverage</a>
                    <a href="{{ url_for('invoice_reimbursement') }}" class="insurance-option reimbursement-option"">Reimbursement</a>
                </div>                
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
        <tr>
            <td>INV34512</td>
            <td>Robert Doromal</td>
            <td>2024-09-06</td>
            <td>Voided</td>
            <td>Approved</td>
            <td class="tamount">₱5,000.00</td>
            <td>
                <a href="{{ url_for('invoice_view') }}" class="btn-view">View</a>
                <a href="#" class="btn-edit">Edit</a>
                <a href="{{ url_for('payment') }}" class="btn-payment" data-status="Voided" data-approval="Approved">Make Payment</a>
                <a href="#" class="btn-insurance" data-status="Voided" data-approval="Approved" onclick="toggleInsuranceBox('INV34512', event)">Apply Insurance</a>
                <div id="insurance-box-INV34512" class="insurance-box">
                    <h3>Apply Insurance</h3>
                    <a href="#" class="insurance-option">Coverage</a>
                    <a href="#" class="insurance-option reimbursement-option"">Reimbursement</a>
                </div>
                <a href="#" class="btn-void" onclick="openVoidModal()">Void</a>
            </td>                             
        </tr>
    </tbody>
</table>

    
<!-- Confirmation Modal for Void -->
<div id="void-confirmation-modal" class="void-confirmation-modal" style="display:none;">
    <div class="void-confirmation-content">
        <p id="void-confirmation-message">Are you sure you want to void this invoice? This action cannot be undone.</p>
        <button class="void-confirmation-confirm" onclick="confirmVoid()">Yes, Void</button>
        <button class="void-confirmation-cancel" onclick="closeVoidModal()">Cancel</button>
    </div>
  </div>
    <!-- Generate Report Button -->
    <div class="generate-report-container">
        <button class="btn-generate-report" onclick="togglePopup()">Generate Report</button>
        
        <!-- Pop-up Box -->
        <div class="invoice-popup" id="popupBox">
            <h3 class="invoice-popup-title">Print as:</h3>

            <!-- Dropdown for Format -->
            <div class="invoice-popup-dropdown-container">
                <label for="format" class="invoice-popup-label">Format:</label>
                <select id="format" class="invoice-popup-dropdown">
                    <option value="pdf">PDF</option>
                    <option value="excel">Excel File</option>
                    <option value="jpg">Jpg</option>
                </select>
            </div>

            <!-- Dropdown for Criteria -->
            <div class="invoice-popup-dropdown-container">
                <label for="criteria" class="invoice-popup-label">Criteria:</label>
                <select id="criteria" class="invoice-popup-dropdown">
                    <option value="date">Date</option>
                    <option value="status">Status</option>
                    <option value="amount">Total Amount</option>
                </select>
            </div>

            <!-- Generate Button -->
            <div class="invoice-popup-generate-container">
                <a href="#" class="invoice-popup-generate">Generate</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/invoice_management.js') }}"></script>
{% endblock %}
